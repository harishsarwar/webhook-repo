<!DOCTYPE html>
<html>
<head>
    <title>GitHub Webhook Events</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
        }
        h1 {
            color: #333;
        }
        .event {
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
            border-left: 4px solid #4CAF50;
            border-radius: 4px;
        }
        .event.pull_request {
            border-left-color: #2196F3;
        }
        .author {
            font-weight: bold;
            color: #1a73e8;
        }
        .branch {
            font-weight: bold;
            color: #e91e63;
        }
        .no-events {
            text-align: center;
            padding: 40px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>GitHub Webhook Events</h1>
        <p>Updates every 15 seconds</p>
        <div id="events"></div>
    </div>

    <script>
        function fetchEvents() {
            fetch('/events')
                .then(response => response.json())
                .then(events => {
                    const eventsDiv = document.getElementById('events');
                    
                    if (events.length === 0) {
                        eventsDiv.innerHTML = '<div class="no-events">No events yet</div>';
                        return;
                    }
                    
                    eventsDiv.innerHTML = events.map(event => {
                        let text = '';
                        if (event.action === 'push') {
                            text = `<span class="author">${event.author}</span> pushed to <span class="branch">${event.to_branch}</span> on ${event.timestamp}`;
                        } else if (event.action === 'pull_request') {
                            text = `<span class="author">${event.author}</span> submitted a pull request from <span class="branch">${event.from_branch}</span> to <span class="branch">${event.to_branch}</span> on ${event.timestamp}`;
                        }
                        
                        return `<div class="event ${event.action}">${text}</div>`;
                    }).join('');
                })
                .catch(error => console.error('Error:', error));
        }

        // Fetch immediately
        fetchEvents();
        
        // Poll every 15 seconds
        setInterval(fetchEvents, 15000);
    </script>
</body>
</html>